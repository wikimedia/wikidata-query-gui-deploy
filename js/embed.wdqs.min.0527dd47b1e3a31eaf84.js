var wikibase=wikibase||{};wikibase.queryService=wikibase.queryService||{},wikibase.queryService.ui=wikibase.queryService.ui||{},wikibase.queryService.ui.resultBrowser=wikibase.queryService.ui.resultBrowser||{},wikibase.queryService.ui.resultBrowser.helper=wikibase.queryService.ui.resultBrowser.helper||{},window.mediaWiki=window.mediaWiki||{},wikibase.queryService.ui.resultBrowser.helper.FormatterHelper=function(a,b,c){"use strict";function d(){}var e="http://www.wikidata.org/entity/Q",f="http://commons.wikimedia.org/wiki/special:filepath/",g="http://www.w3.org/2001/XMLSchema#dateTime",h="uri",i="http://www.w3.org/1998/Math/MathML",j=["http://www.w3.org/2001/XMLSchema#double","http://www.w3.org/2001/XMLSchema#float","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#positiveInteger","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedShort","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#negativeInteger"];return d.prototype.formatRow=function(b,c){var d=this,e=a("<div/>");return a.each(b,function(b,f){e.prepend(a("<div>").append(d.formatValue(f,b,c)))}),e},d.prototype.formatValue=function(b,c,d){var e=b.value,f=a("<span>");if(c||(c=b.dataType||""),!b.type)return a("<span>").text(e).attr("title",c);switch(b.datatype||b.type){case h:var j=a("<a>").attr("href",e).attr("target","_blank").attr("title",c);f.append(j),this.isCommonsResource(e)?d?(j.click(this.handleCommonResourceItem),j.append(a("<img>").attr("src",this.getCommonsResourceFileNameThumbnail(e,"120"))).width("120")):(j.text("commons:"+decodeURIComponent(this.getCommonsResourceFileName(e))),f.prepend(this.createGalleryButton(e,c)," ")):(j.text(this.abbreviateUri(e)),this.isExploreUrl(e)&&f.prepend(this.createExploreButton(e)," "));break;case g:var k=a("<span>").text(this._formatDate(this.parseDate(e)));k.attr("title",c+": "+e),f.append(k);break;case i:f.append(a(b.value));break;default:var l=a("<span>").text(e);b["xml:lang"]?l.attr("title",c+": "+e+"@"+b["xml:lang"]):l.attr("title",c),f.append(l)}return f},d.prototype._formatDate=function(a,b){try{return a.format("ll")}catch(c){return"Invalid date"}},d.prototype.parseDate=function(a){return a.startsWith("+")||a.startsWith("-")||(a="+"+a),a=a.replace(/^\+(\d{1})-/,"+00000$1-").replace(/^\+(\d{2})-/,"+0000$1-").replace(/^\+(\d{3})-/,"+000$1-").replace(/^\+(\d{4})-/,"+00$1-").replace(/^\+(\d{5})-/,"+0$1-"),a=a.replace(/^-(\d{1})-/,"-00000$1-").replace(/^-(\d{2})-/,"-0000$1-").replace(/^-(\d{3})-/,"-000$1-").replace(/^-(\d{4})-/,"-00$1-").replace(/^-(\d{5})-/,"-0$1-"),a=a.replace("Z",""),c(a,c.ISO_8601)},d.prototype.isExploreUrl=function(a){return a&&"string"==typeof a?a.startsWith(e):!1},d.prototype.createExploreButton=function(b){var c=a('<a href="'+b+'" title="Explore item" class="explore glyphicon glyphicon-search" aria-hidden="true">');return c.click(a.proxy(this.handleExploreItem,this)),c},d.prototype.isCommonsResource=function(a){return a.toLowerCase().startsWith(f.toLowerCase())},d.prototype.getCommonsResourceFileName=function(a){var b=new RegExp(f,"ig");return decodeURIComponent(a.replace(b,""))},d.prototype.getCommonsResourceFileNameThumbnail=function(a,b){return this.isCommonsResource(a)?a.replace(/^http(?=:\/\/)/,"https")+"?width="+(b||400):a},d.prototype.createGalleryButton=function(b,c){var d=this.getCommonsResourceFileName(b),e=this.getCommonsResourceFileNameThumbnail(b,900),f=a('<a title="Show Gallery" class="gallery glyphicon glyphicon-picture" aria-hidden="true">').attr("href",e).attr("data-gallery","G_"+c).attr("data-title",decodeURIComponent(d));return f.click(this.handleCommonResourceItem),f},d.prototype.abbreviateUri=function(a){var b,c,d=wikibase.queryService.RdfNamespaces.NAMESPACE_SHORTCUTS;for(b in d)for(c in d[b])if(0===a.indexOf(d[b][c]))return a.replace(d[b][c],c+":");return"<"+a+">"},d.prototype.handleExploreItem=function(c){var d,f,g=a(c.target).attr("href")||"";if(c.preventDefault(),f=g.match(e+"(.+)"),!f)return!1;var h=a(".explorer");return h.empty(),a(".explorer-panel").show(),d=f[1],b.config={get:function(){return"Q"+d}},EXPLORER(a,b,h),!1},d.prototype.handleCommonResourceItem=function(b){b.preventDefault(),a(this).ekkoLightbox({scale_height:!0})},d.prototype.isLabel=function(a){return a&&a.hasOwnProperty?a.hasOwnProperty("xml:lang"):!1},d.prototype.isNumber=function(a){return a&&a.datatype?-1!==j.indexOf(a.datatype):!1},d.prototype.isDateTime=function(a){return a&&a.datatype?a.datatype===g:!1},d.prototype.isEntity=function(a){return a&&a.value?this.isExploreUrl(a.value):!1},d}(jQuery,mediaWiki,moment);var wikibase=wikibase||{};wikibase.queryService=wikibase.queryService||{},wikibase.queryService.ui=wikibase.queryService.ui||{},wikibase.queryService.ui.resultBrowser=wikibase.queryService.ui.resultBrowser||{},wikibase.queryService.ui.resultBrowser.AbstractResultBrowser=function(a,b){"use strict";function c(){this._visitors=[]}return c.prototype._formatter=null,c.prototype._result=null,c.prototype._visitors=null,c.prototype._drawable=!1,c.prototype.setResult=function(a){this._result=a},c.prototype._iterateResult=function(b){var c=this;a.each(this._result.results.bindings,function(d,e){a.each(c._result.head.vars,function(a,f){var g=e[f]||null;c.processVisitors(g,f),b(g,f,e,d)})})},c.prototype.isDrawable=function(){return this._drawable},c.prototype.draw=function(a){jQuery.error("Method draw() needs to be implemented!")},c.prototype.addVisitor=function(a){this._visitors.push(a)},c.prototype.processVisitors=function(b,c){var d=this,e=[];0!==this._visitors.length&&(a.each(this._visitors,function(a,d){d.visit&&"function"==typeof d.visit&&d.visit(b,c)===!1&&e.push(a)}),a.each(e,function(a,b){d._visitors.splice(b,1)}))},c.prototype.visit=function(a){return!1},c.prototype.setFormatter=function(a){this._formatter=a},c.prototype._getFormatter=function(){return null===this._formatter&&(this._formatter=new b.queryService.ui.resultBrowser.helper.FormatterHelper),this._formatter},c.prototype._i18n=function(b,c){var d=null;return a.i18n&&(d=a.i18n(b))!==b?d:c},c}(jQuery,wikibase);var wikibase=wikibase||{};wikibase.queryService=wikibase.queryService||{},wikibase.queryService.ui=wikibase.queryService.ui||{},wikibase.queryService.ui.resultBrowser=wikibase.queryService.ui.resultBrowser||{},wikibase.queryService.ui.resultBrowser.ImageResultBrowser=function(a){"use strict";function b(){}return b.prototype=new wikibase.queryService.ui.resultBrowser.AbstractResultBrowser,b.prototype._grid=null,b.prototype.draw=function(b){var c=this;this._grid=a('<div class="masonry">'),this._iterateResult(function(a,b,d){if(a&&c._isCommonsResource(a.value)){var e=a.value,f=c._getFormatter().getCommonsResourceFileName(e);c._grid.append(c._getItem(c._getThumbnail(e),c._getThumbnail(e,1e3),f,d))}}),b.html(this._grid)},b.prototype._getItem=function(b,c,d,e){var f=a('<a data-gallery="g">').click(this._getFormatter().handleCommonResourceItem).attr("data-title",d).attr("href",c).append(a("<img>").attr("src",b)),g=this._getFormatter().formatRow(e);return a('<div class="item">').append(f,g)},b.prototype._isCommonsResource=function(a){return this._getFormatter().isCommonsResource(a)},b.prototype._getThumbnail=function(a,b){return this._getFormatter().getCommonsResourceFileNameThumbnail(a,b)},b.prototype.visit=function(a){return this._checkImage(a)},b.prototype._checkImage=function(a){return a&&a.value&&this._isCommonsResource(a.value)?(this._drawable=!0,!1):!0},b}(jQuery);var wikibase=wikibase||{};wikibase.queryService=wikibase.queryService||{},wikibase.queryService.ui=wikibase.queryService.ui||{},wikibase.queryService.ui.resultBrowser=wikibase.queryService.ui.resultBrowser||{},window.mediaWiki=window.mediaWiki||{},wikibase.queryService.ui.resultBrowser.TableResultBrowser=function(a,b){"use strict";function c(){}var d=200,e=[10,50,100,200,500,1e3];return c.prototype=new wikibase.queryService.ui.resultBrowser.AbstractResultBrowser,c.prototype._columns=null,c.prototype._rows=null,c.prototype._sorter={string:function(a,b){return a.localeCompare(b)},number:function(a,b){return a>=b?-1:1},generic:function(a,b){if(!b)return 1;if(!a)return-1;var c=this._getFormatter();return c.isNumber(a)&&c.isNumber(b)?this._sorter.number(Number(a.value),Number(b.value)):c.isExploreUrl(a.value)&&c.isExploreUrl(b.value)?this._sorter.number(Number(a.value.replace(/[^0-9]/gi,"")),Number(b.value.replace(/[^0-9]/gi,""))):this._sorter.string(a.value,b.value)}},c.prototype.draw=function(c){var d=this._result;if("undefined"!=typeof d["boolean"]){var e=a("<table>").attr("class","table");return e.append("<tr><td>"+d["boolean"]+"</td></tr>").addClass("boolean"),void c.html(e)}this.columns=d.head.vars,this.rows=d.results.bindings;var f=a("<table/>");c.html(f),this.drawBootstrapTable(f),f.children().width()>a(b).width()&&f.bootstrapTable("toggleView")},c.prototype.drawBootstrapTable=function(b){var c=this,f=this.rows.length>d;jQuery.fn.bootstrapTable.columnDefaults.formatter=function(a,b,d){return a?(c.processVisitors(a,this.field),c._getFormatter().formatValue(a).html()):""};var g={"click .explore":a.proxy(this._getFormatter().handleExploreItem,this),"click .gallery":this._getFormatter().handleCommonResourceItem};b.bootstrapTable({columns:this.columns.map(function(b){return{title:b,field:b,events:g,sortable:!0,sorter:a.proxy(c._sorter.generic,c)}}),data:this.rows,mobileResponsive:!0,search:f,pagination:f,showPaginationSwitch:f,pageSize:d,pageList:e,keyEvents:!0,cookie:!0,cookieIdTable:"1",cookieExpire:"1y",cookiesEnabled:["bs.table.pageList"]})},c.prototype.isDrawable=function(){return!0},c.prototype.visit=function(a){return!1},c}(jQuery,window);var wikibase=wikibase||{};wikibase.queryService=wikibase.queryService||{},wikibase.queryService.ui=wikibase.queryService.ui||{},wikibase.queryService.ui.resultBrowser=wikibase.queryService.ui.resultBrowser||{},wikibase.queryService.ui.resultBrowser.CoordinateResultBrowser=function(a,b,c,d,e){"use strict";function f(){}var g="http://www.opengis.net/ont/geosparql#wktLiteral",h="Q2",i="layer",j="_LAYER_DEFAULT_GROUP",k={wikimedia:{url:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}.png",options:{id:"wikipedia-map-01",attribution:' <a href="http://maps.wikimedia.org/">Wikimedia</a> | &copy; <a href="http://openstreetmap.org/copyright">Open Street Map</a> contributors'}},osm:{url:"http://{s}.tile.osm.org/{z}/{x}/{y}.png",options:{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}}},l=null;return f.prototype=new wikibase.queryService.ui.resultBrowser.AbstractResultBrowser,f.prototype.draw=function(c){var e=a("<div>").attr({id:"map"}).height("100vh");c.html(e);var f=this._getMarkerGroups(),g=b.map("map",{center:[0,0],maxZoom:18,minZoom:2,fullscreenControl:!0,layers:d.compact(f)}).fitBounds(f[j].getBounds());this._setTileLayer(g),g.addControl(b.control.zoomBox({modal:!1,className:"glyphicon glyphicon-zoom-in"})),g.addControl(new l);var h=Object.keys(f).length;h>1&&this._getLayerControl(f).addTo(g),c.html(e)},f.prototype._getLayerControl=function(c){var d=this,e={},f="";return a.each(c,function(a,b){if(a===j)f=d._i18n("wdqs-result-map-layers-all","All layers");else{var c=d._getMarkerGroupColor(a);f='<span style="color:'+c+'">&#x2b24;</span> '+a}e[f]=b}),b.control.layers(null,e)},f.prototype._getMarkerGroups=function(){var c=this,d={};if(d[j]=[],this._iterateResult(function(a,e,f){if(a&&a.datatype===g){var h=c._extractLongLat(a.value);if(null===h||!h[0]||!h[1])return!0;var k=b.popup(),l=h[0],m=h[1],n=f[i]&&f[i].value||j,o=b.circleMarker([m,l],c._getMarkerStyle(n)).bindPopup(k);o.on("click",function(){var a=c._getItemDescription(f);k.setContent(a[0])}),d[n]||(d[n]=[]),d[n].push(o),d[j].push(o)}}),0===Object.keys(d).length){var e=b.marker([0,0]).bindPopup("Nothing found!").openPopup();return{"null":b.featureGroup([e])}}return a.each(d,function(a){d[a]=b.featureGroup(d[a])}),d},f.prototype._getMarkerGroupColor=c.scale.category20(),f.prototype._getMarkerStyle=function(a){var b="#e04545";return a!==j&&(b=this._getMarkerGroupColor(a)),{radius:3,color:b,opacity:.8,fillColor:b,fillOpacity:.9}},f.prototype._extractLongLat=function(a){var b=this._extractGlobe(a);return null!==b&&b!==h?null:(a=a.match(/Point\((.*)\)/).pop(),a.split(" "))},f.prototype._extractGlobe=function(a){var b=null;return(b=a.match(/<http\:\/\/www\.wikidata\.org\/entity\/(.+)>/i))&&(b=b.pop()),b},f.prototype._getItemDescription=function(b){var c=a("<div/>").append(this._getFormatter().formatRow(b,!0));return c},f.prototype._setTileLayer=function(a){var c=k.osm;("query.wikidata.org"===e.location.host||"localhost"===e.location.host||e.location.host.endsWith(".wmflabs.org"))&&(c=k.wikimedia),b.tileLayer(c.url,c.options).addTo(a)},l=b.Control.extend({options:{position:"topright"},onAdd:function(c){var d=b.DomUtil.create("button");return a(d).addClass("btn btn-default"),a(d).append(a(' <span class="glyphicon glyphicon-chevron-up"/> ')),d.onclick=function(){c.isFullscreen()&&c.toggleFullscreen(),a(e).scrollTop(0,0)},d}}),f.prototype.visit=function(a){return this._checkCoordinate(a)},f.prototype._checkCoordinate=function(a){if(a&&a.datatype===g){var b=this._extractGlobe(a.value);if(null===b||b===h)return this._drawable=!0,!1}return!0},f}(jQuery,L,d3,_,window);var wikibase=wikibase||{};wikibase.queryService=wikibase.queryService||{},wikibase.queryService.ui=wikibase.queryService.ui||{},wikibase.queryService.ui.resultBrowser=wikibase.queryService.ui.resultBrowser||{},window.mediaWiki=window.mediaWiki||{},wikibase.queryService.ui.resultBrowser.AbstractChartResultBrowser=function(a,b){"use strict";function c(){}return c.prototype=new wikibase.queryService.ui.resultBrowser.AbstractResultBrowser,c.prototype._getLabelColumns=function(){var a=this,b=a._getRows()[0];return a._getColumns().filter(function(c){return a._getFormatter().isLabel(b[c])})},c.prototype._getNumberColumns=function(){var a=this,b=a._getRows()[0];return a._getColumns().filter(function(c){return a._getFormatter().isNumber(b[c])})},c.prototype._getColumns=function(){return this._result.head.vars},c.prototype._getRows=function(){return this._result.results.bindings},c}(jQuery,window);var wikibase=wikibase||{};wikibase.queryService=wikibase.queryService||{},wikibase.queryService.ui=wikibase.queryService.ui||{},wikibase.queryService.ui.resultBrowser=wikibase.queryService.ui.resultBrowser||{},window.mediaWiki=window.mediaWiki||{},wikibase.queryService.ui.resultBrowser.TreeMapResultBrowser=function(a,b,c){"use strict";function d(){this._labelColumns={}}return d.prototype=new wikibase.queryService.ui.resultBrowser.AbstractChartResultBrowser,d.prototype._labelColumns=null,d.prototype.draw=function(a){var b=this,c={},d=c,e=null,f=null,g=null;this._iterateResult(function(a,h,i){i!==g&&(null!==g&&(d.data={size:e,url:f},e=null,f=null,d=c),g=i),b._getFormatter().isLabel(a)&&(d[a.value]||(d[a.value]={}),d=d[a.value]),b._getFormatter().isNumber(a)&&(e=a.value),a&&a.value&&b._getFormatter().isExploreUrl(a.value)&&(f=a.value)}),d.data={size:e,url:f};var h=this._createTreeData(c),i={name:"treeMap",children:h};this._draw(a,i)},d.prototype._createTreeData=function(b){var c,d=this,e=[];return b.data?e:(a.each(b,function(a,b){var f=d._createTreeData(b);if(0!==f.length)c={id:a,name:a,children:f};else{var g=1;b.data.size&&b.data.size>0&&(g=b.data.size);var h=a,i=b.data.url;i&&(h=i),c={id:h+Math.random(),name:a,size:g,url:i}}e.push(c)}),e)},d.prototype._draw=function(d,e){function f(a){return a.size}function g(a){return 1}function h(a){var b=a.substring(1,3),c=a.substring(3,5),d=a.substring(5,7);return{R:parseInt(b,16),G:parseInt(c,16),B:parseInt(d,16)}}function i(a){var b=105,c=h(a),d=.299*c.R+.587*c.G+.114*c.B;return b>255-d?"#000000":"#ffffff"}function j(a){v.padding([s/(o/a.dy),0,0,0]).nodes(a);var c=n/a.dx,d=o/a.dy,e=a;p.domain([a.x,a.x+a.dx]),q.domain([a.y,a.y+a.dy]),w.selectAll(".labelbody .label").style("display","block");var f=w.selectAll("g.cell").transition().duration(u).attr("transform",function(a){return"translate("+p(a.x)+","+q(a.y)+")"}).each("end",function(a,b){b||e===self.root||(w.selectAll(".cell.child").filter(function(a){return a.parent===self.node}).select(".foreignObject .labelbody .label").style("color",function(a){return i(r(a.parent.name))}),m?w.selectAll(".cell.child").filter(function(a){return a.parent===self.node}).select(".foreignObject").style("display",""):w.selectAll(".cell.child").filter(function(a){return a.parent===self.node}).select(".foreignObject .labelbody .label").style("display",""))});f.select(".foreignObject").attr("width",function(a){return Math.max(.01,c*a.dx)}).attr("height",function(a){return a.children?s:Math.max(.01,d*a.dy)}).select(".labelbody .label").text(function(a){return a.name}),f.select("rect").attr("width",function(a){return Math.max(.01,c*a.dx)}).attr("height",function(a){return a.children?s:Math.max(.01,d*a.dy)}).style("fill",function(a){return a.children?t:r(a.parent.name)}),l=a,b.event&&b.event.stopPropagation()}var k,l,m=!1,n=a(c).width(),o=a(c).height(),p=b.scale.linear().range([0,n]),q=b.scale.linear().range([0,o]),r=b.scale.category10(),s=20,t="#555555",u=500,v=b.layout.treemap().round(!1).size([n,o]).sticky(!0).value(function(a){return a.size}),w=b.select(d[0]).append("svg:svg").attr("width",n).attr("height",o).append("svg:g");l=k=e;var x=v.nodes(k),y=x.filter(function(a){return!a.children}),z=x.filter(function(a){return a.children}),A=w.selectAll("g.cell.parent").data(z,function(a){return"p-"+a.id}),B=A.enter().append("g").attr("class","cell parent").on("click",function(a){j(a)});B.append("rect").attr("width",function(a){return Math.max(.01,a.dx)}).attr("height",s).style("fill",t),B.append("foreignObject").attr("class","foreignObject").append("xhtml:body").attr("class","labelbody").append("div").attr("class","label");var C=A.transition().duration(u);C.select(".cell").attr("transform",function(a){return"translate("+a.dx+","+a.y+")"}),C.select("rect").attr("width",function(a){return Math.max(.01,a.dx)}).attr("height",s).style("fill",t),C.select(".foreignObject").attr("width",function(a){return Math.max(.01,a.dx)}).attr("height",s).select(".labelbody .label").text(function(a){return a.name}),A.exit().remove();var D=w.selectAll("g.cell.child").data(y,function(a){return"c-"+a.id}),E=D.enter().append("g").attr("class","cell child").on("click",function(a){j(l===a.parent?k:a.parent)});E.append("rect").classed("background",!0).style("fill",function(a){return r(a.parent.name)}),E.append("foreignObject").attr("class","foreignObject").attr("width",function(a){return Math.max(.01,a.dx)}).attr("height",function(a){return Math.max(.01,a.dy)}).append("xhtml:body").attr("class","labelbody").append("div").attr("class","label").text(function(a){return a.name}).on("click",function(a){a.url&&(c.open(a.url,"_blank"),b.event.stopPropagation())});var F=D.transition().duration(u);F.select(".cell").attr("transform",function(a){return"translate("+a.x+","+a.y+")"}),F.select("rect").attr("width",function(a){return Math.max(.01,a.dx)}).attr("height",function(a){return a.dy}).style("fill",function(a){return r(a.parent.name)}),F.select(".foreignObject").attr("width",function(a){return Math.max(.01,a.dx)}).attr("height",function(a){return Math.max(.01,a.dy)}).select(".labelbody .label").text(function(a){return a.name}),D.exit().remove(),b.select("select").on("change",function(){console.log("select zoom(node)"),v.value("size"==value?f:g).nodes(k),j(l)}),j(l)},d.prototype.isDrawable=function(){return Object.keys(this._labelColumns).length>1},d.prototype.visit=function(a,b){return this._checkColumn(a,b)},d.prototype._checkColumn=function(a,b){return this._getFormatter().isLabel(a,b)?(this._labelColumns[b]=!0,!this.isDrawable()):!0},d}(jQuery,d3,window);var wikibase=wikibase||{};wikibase.queryService=wikibase.queryService||{},wikibase.queryService.ui=wikibase.queryService.ui||{},wikibase.queryService.ui.resultBrowser=wikibase.queryService.ui.resultBrowser||{},window.mediaWiki=window.mediaWiki||{},wikibase.queryService.ui.resultBrowser.BubbleChartResultBrowser=function(a,b,c){"use strict";function d(){}return d.prototype=new wikibase.queryService.ui.resultBrowser.AbstractChartResultBrowser,d.prototype._hasLabel=!1,d.prototype._hasNumber=!1,d.prototype.draw=function(b){var c=this,d={name:"bubblechart",children:[]},e=this._getLabelColumns()[0],f=this._getNumberColumns()[0],g=null,h=null;this._iterateResult(function(a,b,i){if(a&&a.value&&c._getFormatter().isExploreUrl(a.value)&&(h=a.value),i!==g){var j={url:h};h=null,g=i,i.rgb&&i.rgb.value.match(/^[0-9A-F]{6}$/)&&(j.color="#"+i.rgb.value),i[e]&&i[f]&&(j.name=i[e].value,j.size=i[f].value,d.children.push(j))}});var i=a("<center>");b.html(i),this._drawBubbleChart(i,d)},d.prototype._drawBubbleChart=function(e,f){function g(a){function b(a,d){d.children?d.children.forEach(function(a){b(d.name,a)}):c.push({packageName:a,className:d.name,value:d.size,url:d.url,color:d.color})}var c=[];return b(null,a),{children:c}}var h=Math.min(a(c).height(),a(c).width()),i=b.format(",d"),j=b.scale.category20c(),k=b.layout.pack().sort(null).size([h,h]).padding(1.5),l=b.select(e[0]).append("svg").attr("width",h).attr("height",h).attr("class","bubble"),m=l.selectAll(".node").data(k.nodes(g(f)).filter(function(a){return!a.children})).enter().append("g").attr("class","node").attr("transform",function(a){return"translate("+a.x+","+a.y+")"});m.append("title").text(function(a){return a.className+": "+i(a.value)}),m.append("circle").attr("r",function(a){return a.r}).style("fill",function(a){return a.color||j(a.className)}),m.append("text").attr("dy",".3em").style("text-anchor","middle").text(function(a){return a.className.substring(0,a.r/4)}).on("click",function(a){a.url&&c.open(a.url,"_blank")}).style("fill",function(a){return a.color?d.prototype._calculateLuma(a.color)<=.5?"#FFF":"#000":void 0}).style("cursor","pointer")},d.prototype.isDrawable=function(){return this._hasLabel&&this._hasNumber},d.prototype.visit=function(a){return this._checkColumn(a)},d.prototype._checkColumn=function(a){return this._getFormatter().isNumber(a)&&(this._hasNumber=!0),this._getFormatter().isLabel(a)&&(this._hasLabel=!0),!this.isDrawable()},d.prototype._calculateLuma=function(a){var b=parseInt(a.substr(1,2),16)/255,c=parseInt(a.substr(3,2),16)/255,d=parseInt(a.substr(5,2),16)/255;if(isFinite(b)&&isFinite(c)&&isFinite(d)){b=.04045>=b?b/12.92:Math.pow((b+.055)/1.055,2.4),c=.04045>=c?c/12.92:Math.pow((c+.055)/1.055,2.4),d=.04045>=d?d/12.92:Math.pow((d+.055)/1.055,2.4);var e=.2126*b+.7152*c+.0722*d;return e}return NaN},d}(jQuery,d3,window);var wikibase=wikibase||{};wikibase.queryService=wikibase.queryService||{},wikibase.queryService.ui=wikibase.queryService.ui||{},wikibase.queryService.ui.resultBrowser=wikibase.queryService.ui.resultBrowser||{},wikibase.queryService.ui.resultBrowser.TimelineResultBrowser=function(a,b,c,d){"use strict";function e(){}var f={minHeight:"400px",orientation:{axis:"both",item:"top"},align:"auto",zoomKey:"ctrlKey"};return e.prototype=new wikibase.queryService.ui.resultBrowser.AbstractResultBrowser,e.prototype.draw=function(c){var d=a("<div>"),e=new b.Timeline(d[0],this._getItems(),f);c.append(d.prepend(this._createToolbar(e)))},e.prototype._getItems=function(){var a=this,c=[];return this._iterateResult(function(b,d,e,f){if(a._getFormatter().isDateTime(b))if(c[f]){var g=[];g.push(a._getFormatter().parseDate(b.value)),c[f].start&&g.push(c[f].start),c[f].end&&g.push(c[f].end),c[f].start=g.reduce(function(a,b){return b>a?a:b}),c[f].end=g.reduce(function(a,b){return a>b?a:b})}else c[f]={id:f,content:a._getHtml(e).html(),start:a._getFormatter().parseDate(b.value)}}),new b.DataSet(d.compact(c))},e.prototype._getHtml=function(b){var c=a("<div/>").append(this._getFormatter().formatRow(b,!0));return c},e.prototype._createToolbar=function(b){function c(a){var c=b.getWindow(),d=c.end-c.start;b.setWindow({start:c.start.valueOf()-d*a,end:c.end.valueOf()+d*a})}var d=a('<div style="margin-top: -35px; text-align: center;">');return a('<a class="btn btn-default">').click(a.proxy(b.redraw,b)).append('<span class="glyphicon glyphicon-resize-vertical" aria-hidden="true"></span>').appendTo(d),a('<a class="btn btn-default">').click(a.proxy(b.fit,b)).append('<span class="glyphicon glyphicon-resize-horizontal" aria-hidden="true"></span>').appendTo(d),a('<a class="btn btn-default">').click(function(){c(.2)}).append('<span class="glyphicon glyphicon-zoom-out" aria-hidden="true"></span>').appendTo(d),a('<a class="btn btn-default">').click(function(){c(-.2)}).append('<span class="glyphicon glyphicon-zoom-in" aria-hidden="true"></span>').appendTo(d),d},e.prototype.visit=function(a){return this._getFormatter().isDateTime(a)?(this._drawable=!0,!1):!0},e}(jQuery,vis,window,_);var wikibase=wikibase||{};wikibase.queryService=wikibase.queryService||{},wikibase.queryService.ui=wikibase.queryService.ui||{},wikibase.queryService.ui.resultBrowser=wikibase.queryService.ui.resultBrowser||{},window.mediaWiki=window.mediaWiki||{},wikibase.queryService.ui.resultBrowser.MultiDimensionResultBrowser=function(a,b,c){"use strict";function d(){}var e="http://www.w3.org/2001/XMLSchema#dateTime";return d.prototype=new wikibase.queryService.ui.resultBrowser.AbstractChartResultBrowser,d.prototype.draw=function(a){var b={},c=[],d=this._getFormatter();this._iterateResult(function(a,f,g,h){if(c[h]||(c[h]={}),c[h][f]=a&&a.value||"undefined",a&&a.type===e&&(c[h][f]=new Date(a.value).toLocaleDateString()),!b[f]){var i={key:f,description:f,type:"STRING"};d.isNumber(a)&&(i.type="NUMBER"),a&&a.type===e&&(i.type="DATE"),b[f]=i}}),this._draw(a,c,_.values(b))},d.prototype._draw=function(d,e,f){function g(a){return o(f.map(function(b){return[n(b.key),b.scale(a[b.key])]}))}function h(){b.event.sourceEvent.stopPropagation()}function i(){var a=f.filter(function(a){return!a.brush.empty()}),c=a.map(function(a){return a.brush.extent()}),d=[];b.selectAll(".foreground path").style("display",function(b){return a.every(function(a,d){return a.type.within(b[a.key],c[d],a)})?(d.push(b),null):"none"})}var j={top:50,right:80,bottom:10,left:100},k=a(c).width()-(j.left+j.right),l=a(c).height()-(j.top+j.bottom),m={NUMBER:{key:"Number",coerce:function(a){return+a},extent:b.extent,within:function(a,b){return b[0]<=a&&a<=b[1]},defaultScale:b.scale.linear().range([l,0])},STRING:{key:"String",coerce:String,extent:function(a){return a.sort()},within:function(a,b,c){return b[0]<=c.scale(a)&&c.scale(a)<=b[1]},defaultScale:b.scale.ordinal().rangePoints([0,l])},DATE:{key:"Date",coerce:function(a){return new Date(a)},extent:b.extent,within:function(a,b){return b[0]<=a&&a<=b[1]},defaultScale:b.time.scale().range([0,l])}};a.each(f,function(){this.type=m[this.type]});var n=b.scale.ordinal().domain(f.map(function(a){return a.key})).rangePoints([0,k]),o=b.svg.line().defined(function(a){return!isNaN(a[1])}),p=b.svg.axis().orient("left"),q=b.select(d[0]).append("svg").attr("width",k+j.left+j.right).attr("height",l+j.top+j.bottom).append("g").attr("transform","translate("+j.left+","+j.top+")"),r=q.append("g").attr("class","foreground"),s=q.selectAll(".axis").data(f).enter().append("g").attr("class","axis").attr("transform",function(a){return"translate("+n(a.key)+")"});e.forEach(function(a){f.forEach(function(b){a[b.key]=b.type.coerce(a[b.key])})}),f.forEach(function(a){"domain"in a||(a.domain=b.functor(a.type.extent)(e.map(function(b){return b[a.key]})),a.domain.sort(function(a,b){return a-b})),"scale"in a||(a.scale=a.type.defaultScale.copy()),a.scale.domain(a.domain)}),r.selectAll("path").data(e).enter().append("path").attr("d",g).style("stroke",function(a){return"#6ac"}),s.append("g").attr("class","axis").each(function(a){var c="axis"in a?a.axis.scale(a.scale):p.scale(a.scale);b.select(this).call(c)}).append("text").attr("class","title").attr("text-anchor","start").text(function(a){return"description"in a?a.description:a.key}),s.append("g").attr("class","brush").each(function(a){b.select(this).call(a.brush=b.svg.brush().y(a.scale).on("brushstart",h).on("brush",i))}).selectAll("rect").attr("x",-8).attr("width",16)},d.prototype.isDrawable=function(){return this._drawable},d.prototype.visit=function(a){return this._drawable=!0,!1},d}(jQuery,d3,window);var wikibase=wikibase||{};wikibase.queryService=wikibase.queryService||{},wikibase.queryService.ui=wikibase.queryService.ui||{},wikibase.queryService.ui.resultBrowser=wikibase.queryService.ui.resultBrowser||{},wikibase.queryService.ui.resultBrowser.GraphResultBrowser=function(a,b,c,d){"use strict";function e(){}var f={autoResize:!0,physics:{stabilization:{enabled:!0,iterations:10,fit:!0}},nodes:{shadow:!0,color:"#fff"},edges:{arrows:{to:!0}}};return e.prototype=new wikibase.queryService.ui.resultBrowser.AbstractResultBrowser,e.prototype.draw=function(d){var e=a("<div>").height("100vh"),g=new b.Network(e[0],this._getData(),f);g.on("doubleClick",function(a){1===a.nodes.length&&c.open(a.nodes[0],"_blank")}),e.prepend(this._createToolbar(g)),d.append(e)},e.prototype._createToolbar=function(b){function c(a){b.setOptions({layout:{hierarchical:{direction:a,sortMethod:"directed"}}})}var d=a('<div style="margin-top: -35px; text-align: center;">');return a('<a class="btn btn-default">').click(function(){b.stabilize(100)}).append('<span class="glyphicon glyphicon-fullscreen" aria-hidden="true"></span>').appendTo(d),a('<a class="btn btn-default">').click(function(){c("LR")}).append('<span class="glyphicon glyphicon-indent-left" aria-hidden="true"></span>').appendTo(d),a('<a class="btn btn-default">').click(function(){c("UD")}).append('<span class="glyphicon glyphicon-align-center" aria-hidden="true"></span>').appendTo(d),a('<a class="btn btn-default">').click(function(){c("RL")}).append('<span class="glyphicon glyphicon-indent-right" aria-hidden="true"></span>').appendTo(d),d},e.prototype._getData=function(){var a={},c={},e=[],f=this._getFormatter(),g={};return this._iterateResult(function(b,d,h,i){if(b&&b.value){if(f.isEntity(b)){var j=h[d+"Label"]&&h[d+"Label"].value||b.value,k=b.value;if(g={id:k,label:j,title:j},e[i]){var l={from:e[i],to:k};c[l.from+l.to]=l,a[k]||(a[k]=g)}else a[k]=g,e[i]=g.id}f.isCommonsResource(b.value)&&(g.image=f.getCommonsResourceFileNameThumbnail(b.value,150),g.shape="image"),f.isNumber(b)&&(g.value=b.value,g.title+=" value:"+b.value,g.shape="dot")}}),{nodes:new b.DataSet(d.compact(a)),edges:new b.DataSet(d.compact(c))}},e.prototype.visit=function(a){return this._getFormatter().isEntity(a)?(this._drawable=!0,!1):!0},e}(jQuery,vis,window,_);var wikibase=wikibase||{};wikibase.queryService=wikibase.queryService||{},wikibase.queryService.api=wikibase.queryService.api||{},wikibase.queryService.api.Sparql=function(a){"use strict";function b(a){this._serviceUri=a||c}var c="//query.wikidata.org/bigdata/namespace/wdq/sparql";return b.prototype._serviceUri=null,b.prototype._executionTime=null,b.prototype._errorMessage=null,b.prototype._resultLength=null,b.prototype._rawData=null,b.prototype._queryUri=null,b.prototype.queryDataUpdatedTime=function(){var b=a.Deferred(),c=encodeURI("prefix schema: <http://schema.org/> SELECT * WHERE {<http://www.wikidata.org> schema:dateModified ?y}"),d=this._serviceUri+"?query="+c+"&nocache="+Math.floor(Date.now()/6e4),e={headers:{Accept:"application/sparql-results+json"}};return a.ajax(d,e).done(function(a,c,d){if(!a.results.bindings[0])return void b.reject();var e=new Date(a.results.bindings[0][a.head.vars[0]].value),f=e.toLocaleTimeString(navigator.language,{timeZoneName:"short"})+", "+e.toLocaleDateString(navigator.language,{month:"short",day:"numeric",year:"numeric"}),g=Math.round((new Date-e)/1e3);b.resolve(f,g)}).fail(function(){b.reject()}),b},b.prototype.query=function(b){
var c=this,d=a.Deferred(),e={headers:{Accept:"application/sparql-results+json"}};return this._queryUri=this._serviceUri+"?query="+encodeURIComponent(b),this._executionTime=Date.now(),a.ajax(this._queryUri,e).done(function(a,b,e){c._executionTime=Date.now()-c._executionTime,"boolean"==typeof a["boolean"]?c._resultLength=1:c._resultLength=a.results.bindings.length||0,c._rawData=a,d.resolve()}).fail(function(a){c._executionTime=null,c._rawData=null,c._resultLength=null,c._generateErrorMessage(a),d.reject()}),d},b.prototype._generateErrorMessage=function(a){var b="ERROR: ";0===a.status?b+="Could not contact server":(b+=a.responseText,a.responseText.match(/Query deadline is expired/)&&(b="QUERY TIMEOUT\n"+b)),this._errorMessage=b},b.prototype.getExecutionTime=function(){return this._executionTime},b.prototype.getErrorMessage=function(){return this._errorMessage},b.prototype.getResultLength=function(){return this._resultLength},b.prototype.getQueryUri=function(){return this._queryUri},b.prototype._processData=function(a,b,c){for(var d=a.results.bindings.length,e=0;d>e;e++){for(var f={},g=0;g<a.head.vars.length;g++)a.head.vars[g]in a.results.bindings[e]?f[a.head.vars[g]]=a.results.bindings[e][a.head.vars[g]]:f[a.head.vars[g]]=void 0;c=b(f,c)}return c},b.prototype._encodeCsv=function(a){var b=a.replace(/"/g,'""');return/[",\n]/.test(b)&&(b='"'+b+'"'),b},b.prototype.getResultRawData=function(){return this._rawData},b.prototype.getResultAsCsv=function(){var a=this,b=a._rawData,c=b.head.vars.map(this._encodeCsv).join(",")+"\n";return c=this._processData(b,function(b,c){var d,e="",f=!0;for(var g in b)d=void 0===b[g]?"":a._encodeCsv(b[g].value),f?f=!1:e+=",",e+=d;return e+="\n",c+e},c)},b.prototype.getResultAsJson=function(){var a=[],b=this._rawData;return a=this._processData(b,function(a,b){var c={};for(var d in a)c[d]=(a[d]||{}).value;return b.push(c),b},a),JSON.stringify(a)},b.prototype.getResultAsAllJson=function(){return JSON.stringify(this._rawData)},b.prototype._renderValueTSV=function(a){var b=a.value.replace(/\t/g,"");switch(a.type){case"uri":return"<"+b+">";case"bnode":return"_:"+b;case"literal":var c=JSON.stringify(b);return a["xml:lang"]?c+"@"+a["xml:lang"]:a.datatype?"http://www.w3.org/2001/XMLSchema#integer"===a.datatype||"http://www.w3.org/2001/XMLSchema#decimal"===a.datatype||"http://www.w3.org/2001/XMLSchema#double"===a.datatype?b:c+"^^<"+a.datatype+">":c}return b},b.prototype.getSparqlTsv=function(){var a=this,b=this._rawData,c=b.head.vars.map(function(a){return"?"+a}).join("	")+"\n";return c=this._processData(b,function(b,c){var d,e="",f=!0;for(var g in b)d=void 0===b[g]?"":a._renderValueTSV(b[g]),f?f=!1:e+="	",e+=d;return e+="\n",c+e},c)},b.prototype.getSimpleTsv=function(){var a=this._rawData,b=a.head.vars.join("	")+"\n";return b=this._processData(a,function(a,b){var c,d="",e=!0;for(var f in a)c=void 0===a[f]?"":a[f].value.replace(/\t/g,""),e?e=!1:d+="	",d+=c;return d+="\n",b+d},b)},b}(jQuery);var wikibase=wikibase||{};wikibase.queryService=wikibase.queryService||{},wikibase.queryService.RdfNamespaces={},function(a,b){"use strict";b.NAMESPACE_SHORTCUTS={Wikidata:{wikibase:"http://wikiba.se/ontology#",wd:"http://www.wikidata.org/entity/",wdt:"http://www.wikidata.org/prop/direct/",wds:"http://www.wikidata.org/entity/statement/",p:"http://www.wikidata.org/prop/",wdref:"http://www.wikidata.org/reference/",wdv:"http://www.wikidata.org/value/",ps:"http://www.wikidata.org/prop/statement/",psv:"http://www.wikidata.org/prop/statement/value/",pq:"http://www.wikidata.org/prop/qualifier/",pqv:"http://www.wikidata.org/prop/qualifier/value/",pr:"http://www.wikidata.org/prop/reference/",prv:"http://www.wikidata.org/prop/reference/value/",wdno:"http://www.wikidata.org/prop/novalue/",wdata:"http://www.wikidata.org/wiki/Special:EntityData/"},W3C:{rdfs:"http://www.w3.org/2000/01/rdf-schema#",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",owl:"http://www.w3.org/2002/07/owl#",skos:"http://www.w3.org/2004/02/skos/core#",xsd:"http://www.w3.org/2001/XMLSchema#",prov:"http://www.w3.org/ns/prov#"},"Social/Other":{schema:"http://schema.org/"},Blazegraph:{bd:"http://www.bigdata.com/rdf#",bds:"http://www.bigdata.com/rdf/search#",gas:"http://www.bigdata.com/rdf/gas#",hint:"http://www.bigdata.com/queryHints#"}},b.ENTITY_TYPES={"http://www.wikidata.org/prop/direct/":"property","http://www.wikidata.org/prop/":"property","http://www.wikidata.org/prop/novalue/":"property","http://www.wikidata.org/prop/statement/":"property","http://www.wikidata.org/prop/statement/value/":"property","http://www.wikidata.org/prop/qualifier/":"property","http://www.wikidata.org/prop/qualifier/value/":"property","http://www.wikidata.org/prop/reference/":"property","http://www.wikidata.org/prop/reference/value/":"property","http://www.wikidata.org/wiki/Special:EntityData/":"item","http://www.wikidata.org/entity/":"item"},b.ALL_PREFIXES=a.map(b.NAMESPACE_SHORTCUTS,function(a){return a}).reduce(function(b,c,d){return a.extend(b,c)},{}),b.STANDARD_PREFIXES={wd:"PREFIX wd: <http://www.wikidata.org/entity/>",wdt:"PREFIX wdt: <http://www.wikidata.org/prop/direct/>",wikibase:"PREFIX wikibase: <http://wikiba.se/ontology#>",p:"PREFIX p: <http://www.wikidata.org/prop/>",ps:"PREFIX ps: <http://www.wikidata.org/prop/statement/>",pq:"PREFIX pq: <http://www.wikidata.org/prop/qualifier/>",rdfs:"PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>",bd:"PREFIX bd: <http://www.bigdata.com/rdf#>"},b.getPrefixMap=function(c){var d={};return a.each(b.ALL_PREFIXES,function(a,b){c[b]&&(d[a]=c[b])}),d}}(jQuery,wikibase.queryService.RdfNamespaces);